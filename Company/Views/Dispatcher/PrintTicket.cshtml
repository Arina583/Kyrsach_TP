@model Tickets
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ПассажирскийПуть | Ваш билет</title>
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
</head>
<body>
    <div class="container mt-5">
        <h1>Билет</h1>
        <div id="ticketContent">
            <div class="card p-3">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                        <p>Рейс: @Model.Flight.numberFlight</p>
                        <p>Маршрут: @Model.Flight.Route.cityDeparture.nameStop → @Model.Flight.Route.cityArrival.nameStop</p>
                    </li>
                    <li class="list-group-item">Номер места: @Model.numberSeat</li>
                    <li class="list-group-item">Цена билета: @Model.Flight.price руб.</li>
                    <li class="list-group-item">Время: @Model.Flight.timeDeparture - @Model.Flight.timeArrival</li>
                </ul>
            </div>
        </div>

        <div class="modal-footer">
            <a class="btn btn-success" asp-area="" asp-controller="Account" asp-action="DispatcherDashboard">На главную</a>
        </div>

        <div class="modal fade" id="printModal" tabindex="-1" role="dialog" aria-labelledby="printModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="printModalLabel">Ваш билет успешно приобретён!</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Закрыть">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        Нажмите ниже, чтобы распечатать билет:
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" onclick="printTicket()">Распечатать билет</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Скрипты-->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script>
            $(document).ready(function () {
                $('#printModal').modal('show');
            });

            function printTicket() {
               $('#printModal').modal('hide');

               var printContents = document.getElementById('ticketContent').innerHTML;
               var originalContents = document.body.innerHTML;

               document.body.innerHTML = printContents;
               window.print();
               document.body.innerHTML = originalContents;
               location.reload();
            }
        </script>

    </div>
</body>
</html>