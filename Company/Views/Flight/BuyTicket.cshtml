@model Company.Models.Flights

@{
    ViewData["Title"] = "Купить билет";
    Layout = null;
    string routeName = $"{Model.Route.cityDeparture.nameStop} - {Model.Route.cityArrival.nameStop}";
}

<!DOCTYPE html>
<html>
<head>
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/Buy.css" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
</head>
<body>
    <header>Покупка билета на рейс @routeName</header>

    <h3>Выберите место</h3>
    <hr />
    <form asp-action="ReserveSeat" asp-controller="Flight" method="post" id="reservationForm">
        <input type="hidden" asp-for="Id" />
        <input type="hidden" id="seatNumber" name="seatNumber" value="" required />
        <input type="hidden" id="actionType" name="actionType" value="" />
        <input type="hidden" id="email" name="email" value="" />

        <div class="seat-grid">
            @for (int i = 1; i <= 39; i++)
            {
                string seatClass = "seat";
                if (ViewBag.ReservedSeats != null && ViewBag.ReservedSeats.Contains(i))
                {
                    seatClass += " reserved";
                }
                <div class="@seatClass" data-seatnumber="@i">@i</div>
            }
        </div>

        <button type="button" id="buyButton">Купить</button>
        <button type="button" id="reserveButton">Забронировать</button>

        <div id="emailModal" style="display:none;position:fixed;top:30%;left:50%;transform:translateX(-50%);background:#fff;padding:20px;border:1px solid #ccc;z-index:1000;">
            <label>Введите вашу почту для бронирования:</label><br />
            <input type="email" id="emailInput" required />
            <button type="button" id="confirmReserve">Подтвердить</button>
            <button type="button" id="cancelReserve">Отмена</button>
        </div>
        <div id="modalOverlay" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#00000066;z-index:999;"></div>
    </form>
    <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2025 - ПассажирскийПуть - <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
        </div>
    </footer>
</body>
<script src="~/js/buyTicket.js"></script>
</html>
